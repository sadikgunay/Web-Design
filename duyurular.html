<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8">
    <title>Duyurular | SAATÜRN</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;300;400;500&family=Playfair+Display:ital,wght@0,500;0,700;1,500&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    
    <style>
        :root { --gold: #D4AF37; --black-deep: #050505; }
        body { background-color: var(--black-deep); color: #f0f0f0; font-family: 'Montserrat', sans-serif; padding-top: 120px; }
        h1, h2, .serif-font { font-family: 'Playfair Display', serif; }
        
        /* Kart Tasarımı */
        .notice-card { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); padding: 30px; border-radius: 8px; transition: 0.3s; height: 100%; cursor: pointer; }
        .notice-card:hover { transform: translateY(-5px); border-color: var(--gold); background: rgba(255,255,255,0.05); }
        .date-badge { color: var(--gold); font-size: 0.8rem; letter-spacing: 1px; margin-bottom: 10px; display: block; }
        .notice-title { font-size: 1.4rem; color: #fff; margin-bottom: 15px; }
        .notice-desc { color: #aaa; font-size: 0.9rem; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
        
        /* Modal Tasarımı */
        .modal-content { background: #111; border: 1px solid #333; color: #fff; }
        .modal-header { border-bottom: 1px solid #222; }
        .btn-close { filter: invert(1); }
        
        /* Dosya Kutusu (Modal İçi) */
        .file-box { border: 1px dashed var(--gold); padding: 15px; background: rgba(212, 175, 55, 0.1); border-radius: 6px; display: flex; align-items: center; margin-top: 20px; cursor: pointer; transition:0.3s; text-decoration: none; color: #fff; }
        .file-box:hover { background: rgba(212, 175, 55, 0.2); }
    </style>
</head>

<body onload="duyurulariGetir()">

    <nav id="mainNav"></nav>

    <div class="container pb-5">
        <div class="text-center mb-5">
            <span class="text-warning small" style="letter-spacing: 3px;">BASIN ODASI</span>
            <h1 class="display-4 text-white mt-2">Duyurular & Haberler</h1>
        </div>

        <div class="row g-4" id="duyuruListesi"></div>
        
        <div id="bosUyari" class="text-center text-muted mt-5" style="display:none;">
            <i data-feather="inbox" class="mb-2"></i><br>Henüz duyuru bulunmuyor.
        </div>
    </div>

    <div class="modal fade" id="duyuruModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <div>
                        <span class="badge bg-warning text-dark mb-2" id="mEtiket">GENEL</span>
                        <h4 class="modal-title serif-font" id="mBaslik">...</h4>
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <span class="text-secondary small d-block mb-3" id="mTarih"></span>
                    
                    <div id="mResimAlani" class="mb-4 text-center" style="display:none;">
                        <img id="mResim" src="" class="img-fluid rounded border border-secondary" style="max-height: 300px;">
                    </div>

                    <p class="text-light fw-light" id="mIcerik" style="line-height: 1.8; font-size: 1rem;">...</p>

                    <a id="mDosyaLink" href="#" class="file-box" style="display:none;" download>
                        <i data-feather="file-text" class="text-warning me-3"></i>
                        <div>
                            <span class="d-block text-warning small fw-bold" id="mDosyaTipi">DOSYA EKİ</span>
                            <span class="small" id="mDosyaAdi">dosya.pdf</span>
                        </div>
                        <i data-feather="download" class="ms-auto text-secondary"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <footer id="mainFooter"></footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        feather.replace();

        function duyurulariGetir() {
            const liste = JSON.parse(localStorage.getItem('saaturnDuyurular')) || [];
            const container = document.getElementById('duyuruListesi');
            
            container.innerHTML = "";
            
            if(liste.length === 0) {
                document.getElementById('bosUyari').style.display = 'block';
                return;
            }

            liste.forEach((d, index) => {
                // Etiket rengi
                let badgeClass = "bg-secondary";
                if(d.etiket === "ACİL") badgeClass = "bg-danger";
                else if(d.etiket === "İNDİRİM") badgeClass = "bg-success";
                
                // Dosya ikonu var mı?
                let dosyaIkonu = "";
                if(d.dosyaTipi === "PDF" || d.dosyaTipi === "Word") dosyaIkonu = `<i data-feather="paperclip" class="ms-2 text-warning" style="width:14px;"></i>`;

                const html = `
                <div class="col-md-6 col-lg-4">
                    <div class="notice-card" onclick="detayAc(${index})">
                        <span class="date-badge">${d.tarih}</span>
                        <h5 class="notice-title">${d.baslik} ${dosyaIkonu}</h5>
                        <span class="badge ${badgeClass} mb-3">${d.etiket}</span>
                        <p class="notice-desc">${d.icerik}</p>
                        <small class="text-warning text-uppercase" style="letter-spacing:1px; font-size:0.7rem;">Devamını Oku &rarr;</small>
                    </div>
                </div>`;
                container.innerHTML += html;
            });
            feather.replace();
        }

        function detayAc(index) {
            const d = JSON.parse(localStorage.getItem('saaturnDuyurular'))[index];
            
            document.getElementById('mBaslik').innerText = d.baslik;
            document.getElementById('mIcerik').innerText = d.icerik;
            document.getElementById('mTarih').innerText = d.tarih;
            document.getElementById('mEtiket').innerText = d.etiket;

            // 1. Resim Kontrolü
            if(d.dosyaTipi === "Resim" && d.dosyaData) {
                document.getElementById('mResim').src = d.dosyaData;
                document.getElementById('mResimAlani').style.display = 'block';
            } else {
                document.getElementById('mResimAlani').style.display = 'none';
            }

            // 2. Belge (PDF/Word) Kontrolü
            if((d.dosyaTipi === "PDF" || d.dosyaTipi === "Word") && d.dosyaData) {
                const link = document.getElementById('mDosyaLink');
                link.style.display = 'flex';
                link.href = d.dosyaData; // Base64 verisi
                link.download = d.dosyaAdi || "belge"; // İndirilecek dosya adı
                
                document.getElementById('mDosyaTipi').innerText = d.dosyaTipi + " BELGESİ";
                document.getElementById('mDosyaAdi').innerText = d.dosyaAdi;
            } else {
                document.getElementById('mDosyaLink').style.display = 'none';
            }

            new bootstrap.Modal(document.getElementById('duyuruModal')).show();
            feather.replace();
        }
    </script>
    
    <script src="assets/js/footer.js"></script>
    <script src="assets/js/navbar.js"></script>
</body>
</html>