<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Ürün Yönetimi | SAATÜRN Panel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    
    <script>
        // Basit Oturum Kontrolü (Login sayfası yoksa burayı silebilirsiniz test için)
        if(localStorage.getItem("saaturn_session") !== "active") {
            // window.location.href = "admin-login.html"; // Login sayfası varsa açın
        }
    </script>

    <style>
        :root { --gold: #D4AF37; --dark: #050505; --panel: #111; }
        body { background-color: var(--dark); color: #e0e0e0; font-family: 'Montserrat', sans-serif; }
        .sidebar { background: #000; border-right: 1px solid #222; min-height: 100vh; width: 250px; position: fixed; padding-top: 30px; }
        .main-content { margin-left: 250px; padding: 40px; }
        .form-control, .form-select { background-color: #000 !important; border: 1px solid #333; color: #fff !important; }
        .form-control:focus { border-color: var(--gold); box-shadow: none; }
        .table-custom { --bs-table-bg: var(--panel); border: 1px solid #222; color: #ccc; }
        .table-custom th { color: var(--gold); font-weight: normal; font-size: 0.8rem; letter-spacing: 1px; }
        .product-thumb { width: 50px; height: 50px; object-fit: contain; background: #fff; border-radius: 4px; padding: 2px; }
        .btn-warning { background-color: var(--gold); border: none; font-weight: 600; }
        
        @media (max-width: 991px) {
            .sidebar { display: none; } /* Basitlik için mobilde gizledim */
            .main-content { margin-left: 0; }
        }
    </style>
</head>
<body onload="urunleriListele()">

    <nav class="sidebar">
        <div class="text-center mb-5">
            <h4 class="text-warning fw-bold">SAATÜRN</h4>
            <small class="text-muted">PANEL</small>
        </div>
        <div class="d-flex flex-column px-3 gap-2">
            <a href="#" class="text-white text-decoration-none p-2 bg-secondary bg-opacity-10 rounded">Ürün Yönetimi</a>
            <a href="urunler.html" target="_blank" class="text-warning text-decoration-none p-2 mt-4">→ Siteyi Görüntüle</a>
        </div>
    </nav>

    <div class="main-content">
        <div class="d-flex justify-content-between align-items-center mb-5">
            <h3 class="fw-bold text-white">Ürün Kataloğu</h3>
            <button class="btn btn-outline-warning btn-sm" onclick="varsayilanlariYukle()">
                <span data-feather="rotate-ccw"></span> Varsayılanları Yükle
            </button>
        </div>

        <div class="row g-4">
            <div class="col-lg-4">
                <div class="card bg-dark border-secondary">
                    <div class="card-header border-secondary">Yeni Ürün Ekle</div>
                    <div class="card-body">
                        <form id="urunForm">
                            <div class="mb-3">
                                <label class="small text-warning">ÜRÜN ADI</label>
                                <input type="text" id="uAd" class="form-control" required>
                            </div>
                            <div class="mb-3">
                                <label class="small text-warning">KATEGORİ</label>
                                <select id="uKat" class="form-select">
                                    <option value="Prestige Series">Prestige Series</option>
                                    <option value="Elite Series">Elite Series</option>
                                    <option value="Sport / Diver">Sport / Diver</option>
                                    <option value="Classic">Classic</option>
                                    <option value="Limited Edition">Limited Edition</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="small text-warning">FİYAT (₺)</label>
                                <input type="number" id="uFiyat" class="form-control" required>
                            </div>
                            <div class="mb-3">
                                <label class="small text-warning">GÖRSEL</label>
                                <input type="file" id="uResimFile" class="form-control" accept="image/*" onchange="resimOnizle(this)">
                                <img id="imgPreview" src="" style="max-height: 80px; display: none; margin-top: 10px;">
                            </div>
                            <button type="button" class="btn btn-warning w-100" onclick="urunKaydet()">KAYDET</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="col-lg-8">
                <div class="card bg-dark border-secondary">
                    <div class="card-header border-secondary d-flex justify-content-between">
                        <span>Mevcut Ürünler</span>
                        <span id="toplamUrun" class="badge bg-secondary">0</span>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-custom mb-0 align-middle">
                            <thead>
                                <tr>
                                    <th>GÖRSEL</th>
                                    <th>AD</th>
                                    <th>KATEGORİ</th>
                                    <th>FİYAT</th>
                                    <th class="text-end">İŞLEM</th>
                                </tr>
                            </thead>
                            <tbody id="urunTablosu"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        feather.replace();
        let secilenResimBase64 = "";

        // Resim Önizleme
        function resimOnizle(input) {
            if (input.files && input.files[0]) {
                const file = input.files[0];
                if (file.size > 2000000) { alert("Resim çok büyük! Lütfen 2MB altı resim seçin."); return; }
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('imgPreview').src = e.target.result;
                    document.getElementById('imgPreview').style.display = 'block';
                    secilenResimBase64 = e.target.result;
                }
                reader.readAsDataURL(file);
            }
        }

        // Ürün Kaydetme
        function urunKaydet() {
            const ad = document.getElementById('uAd').value;
            const fiyat = document.getElementById('uFiyat').value;
            const kat = document.getElementById('uKat').value;

            if(!ad || !fiyat || !secilenResimBase64) { alert("Lütfen tüm alanları doldurun ve resim seçin."); return; }

            const yeniUrun = {
                id: Date.now(),
                ad: ad,
                kat: kat,
                fiyat: parseInt(fiyat),
                img: secilenResimBase64,
                badge: "YENİ" // Eklenenlere otomatik YENİ etiketi verelim
            };

            try {
                const urunler = JSON.parse(localStorage.getItem('saaturnUrunler')) || [];
                urunler.unshift(yeniUrun); // En başa ekle
                localStorage.setItem('saaturnUrunler', JSON.stringify(urunler));
                
                // Temizlik
                document.getElementById('urunForm').reset();
                document.getElementById('imgPreview').style.display = 'none';
                secilenResimBase64 = "";
                
                urunleriListele();
                alert("Ürün eklendi! Koleksiyon sayfasını yenileyerek görebilirsiniz.");
            } catch (e) {
                alert("Depolama hatası (Kota Doldu). Lütfen bazı ürünleri silin.");
            }
        }

        // Listeleme
        function urunleriListele() {
            const urunler = JSON.parse(localStorage.getItem('saaturnUrunler')) || [];
            const tablo = document.getElementById('urunTablosu');
            tablo.innerHTML = "";
            document.getElementById('toplamUrun').innerText = urunler.length;

            urunler.forEach((u, index) => {
                tablo.innerHTML += `
                    <tr>
                        <td><img src="${u.img}" class="product-thumb"></td>
                        <td class="text-white fw-bold">${u.ad}</td>
                        <td><span class="badge bg-secondary text-dark bg-opacity-75">${u.kat}</span></td>
                        <td class="text-warning">${u.fiyat.toLocaleString()} ₺</td>
                        <td class="text-end">
                            <button class="btn btn-sm btn-outline-danger" onclick="urunSil(${index})">Sil</button>
                        </td>
                    </tr>
                `;
            });
        }

        // Silme
        function urunSil(index) {
            if(confirm("Bu ürünü silmek istiyor musunuz?")) {
                const urunler = JSON.parse(localStorage.getItem('saaturnUrunler'));
                urunler.splice(index, 1);
                localStorage.setItem('saaturnUrunler', JSON.stringify(urunler));
                urunleriListele();
            }
        }

        // Varsayılan Yükleme
        function varsayilanlariYukle() {
            if(confirm("Mevcut liste silinip varsayılan saatler yüklenecek. Onaylıyor musunuz?")) {
                // Not: Resim yolları demo olduğu için 'assets/...' şeklindedir.
                // Gerçek çalışmada bu klasörde resimler olmalı veya base64 kullanılmalı.
                const varsayilanlar = [
                    { id: 1, ad: "Satürn ELITE", kat: "Prestige Series", fiyat: 24000, img: "https://via.placeholder.com/300x400/000000/D4AF37?text=ELITE", badge: "VİTRİN" },
                    { id: 2, ad: "Satürn OCEAN", kat: "Sport / Diver", fiyat: 12400, img: "https://via.placeholder.com/300x400/000000/D4AF37?text=OCEAN", badge: "" },
                    { id: 3, ad: "Satürn TIMELESS", kat: "Classic", fiyat: 9250, img: "https://via.placeholder.com/300x400/000000/D4AF37?text=TIMELESS", badge: "İNDİRİM" }
                ];
                localStorage.setItem('saaturnUrunler', JSON.stringify(varsayilanlar));
                urunleriListele();
            }
        }
    </script>
</body>
</html>

