<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>√úr√ºn Y√∂netimi | SAAT√úRN Panel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>

    <script>
        if(localStorage.getItem("saaturn_session") !== "active") {
            // window.location.href = "admin-login.html"; // G√ºvenlik
        }
    </script>

    <style>
        :root { --gold: #D4AF37; --dark: #050505; --panel: #111; }
        body { background-color: var(--dark); color: #e0e0e0; font-family: 'Montserrat', sans-serif; overflow-x: hidden; }
        
        .sidebar { background: #000; border-right: 1px solid #222; min-height: 100vh; position: fixed; top: 0; left: 0; width: 250px; padding-top: 30px; z-index: 1000; transition: transform 0.3s ease-in-out; }
        .nav-link { color: #bbb; padding: 12px 20px; display: flex; align-items: center; transition: 0.3s; font-size: 0.9rem; margin-bottom: 5px; text-decoration: none; }
        .nav-link:hover, .nav-link.active { color: var(--gold); background: rgba(212, 175, 55, 0.05); border-right: 3px solid var(--gold); }
        .nav-link svg { margin-right: 12px; width: 18px; }

        .main-content { margin-left: 250px; padding: 40px; transition: margin-left 0.3s ease-in-out; }
        .mobile-toggle-btn { display: none; position: fixed; top: 15px; left: 15px; z-index: 1100; background: var(--gold); border: none; padding: 8px; border-radius: 4px; color: #000; }

        .card-custom { background: var(--panel); border: 1px solid #222; border-radius: 12px; height: 100%; margin-bottom: 20px; }
        .card-header-custom { background: transparent; border-bottom: 1px solid #333; padding: 20px; }
        
        label { color: var(--gold) !important; font-size: 0.7rem; letter-spacing: 1px; font-weight: 700; margin-bottom: 8px; display: block; text-transform: uppercase; }
        .form-control, .form-select { background-color: #000 !important; border: 1px solid #333; color: #fff !important; padding: 12px; border-radius: 6px; }
        .form-control:focus, .form-select:focus { border-color: var(--gold); box-shadow: 0 0 10px rgba(212, 175, 55, 0.1); }
        .file-upload-wrapper { border: 1px dashed #444; border-radius: 6px; padding: 5px; background: #080808; transition:0.3s; }
        .file-upload-wrapper:hover { border-color: var(--gold); }
        
        .table-custom { --bs-table-bg: var(--panel); border: 1px solid #222; color: #ccc; margin-top: 0; }
        .table-custom th { border-bottom: 1px solid #333; color: var(--gold); font-weight: normal; padding: 15px; font-size: 0.8rem; letter-spacing: 1px; white-space: nowrap; }
        .table-custom td { border-bottom: 1px solid #222; padding: 15px; vertical-align: middle; font-size: 0.9rem; color: #ddd; }
        .product-thumb { width: 50px; height: 50px; object-fit: contain; background: #fff; border-radius: 4px; padding: 2px; }

        @media (max-width: 991px) {
            .sidebar { transform: translateX(-100%); }
            .sidebar.show { transform: translateX(0); }
            .main-content { margin-left: 0; padding: 20px; padding-top: 70px; }
            .mobile-toggle-btn { display: block; }
        }
    </style>
</head>
<body onload="urunleriListele()">

    <button class="mobile-toggle-btn" onclick="toggleSidebar()">
        <i data-feather="menu"></i>
    </button>

    <nav class="sidebar" id="sidebar">
        <div class="text-center mb-5">
            <h4 class="text-warning fw-bold pt-2">SAAT√úRN</h4>
            <small class="text-muted" style="color:#888 !important;">Y√ñNETƒ∞Cƒ∞ PANELƒ∞</small>
            <button class="btn btn-sm btn-outline-secondary d-lg-none position-absolute top-0 end-0 m-3" onclick="toggleSidebar()">X</button>
        </div>
        <div class="d-flex flex-column">
            <a href="admin-panel.html" class="nav-link"><span data-feather="grid"></span> Genel Bakƒ±≈ü</a>
            <a href="admin-urunler.html" class="nav-link active"><span data-feather="box"></span> √úr√ºn Y√∂netimi</a>
            <a href="admin-duyuru-ekle.html" class="nav-link"><span data-feather="edit"></span> Duyuru Y√∂netimi</a>
            <a href="istatistik.html" class="nav-link"><span data-feather="pie-chart"></span> ƒ∞statistikler</a>
            
            <div class="mt-5 border-top border-secondary pt-3">
                <a href="urunler.html" target="_blank" class="nav-link"><span data-feather="external-link"></span> Siteye Git</a>
                <a href="#" onclick="cikisYap()" class="nav-link text-danger"><span data-feather="log-out"></span> √áƒ±kƒ±≈ü Yap</a>
            </div>
        </div>
    </nav>

    <div class="main-content">
        <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-5 gap-3">
            <div>
                <h6 class="text-secondary mb-1" style="color:#aaa !important;">ENVANTER</h6>
                <h3 class="fw-bold m-0 text-white">√úr√ºn Kataloƒüu</h3>
            </div>
            </div>

        <div class="row g-4">
            <div class="col-lg-5">
                <div class="card-custom">
                    <div class="card-header-custom">
                        <h5 class="text-white m-0">Yeni √úr√ºn Ekle</h5>
                    </div>
                    <div class="card-body p-4">
                        <form id="urunForm">
                            <div class="mb-3">
                                <label>√úR√úN ADI</label>
                                <input type="text" id="uAd" class="form-control" placeholder="√ñrn: Sat√ºrn Chrono" required>
                            </div>
                            
                            <div class="row g-3">
                                <div class="col-md-6 col-12 mb-3">
                                    <label>KATEGORƒ∞</label>
                                    <select id="uKat" class="form-select">
                                        <option value="Prestige Series">Prestige Series</option>
                                        <option value="Elite Series">Elite Series</option>
                                        <option value="Sport / Diver">Sport / Diver</option>
                                        <option value="Classic">Classic</option>
                                        <option value="Limited Edition">Limited Edition</option>
                                    </select>
                                </div>
                                <div class="col-md-6 col-12 mb-3">
                                    <label>Fƒ∞YAT (‚Ç∫)</label>
                                    <input type="number" id="uFiyat" class="form-control" placeholder="0" required>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label>Hƒ∞KAYE & A√áIKLAMA</label>
                                <textarea id="uDesc" class="form-control" rows="2" placeholder="√úr√ºn√ºn hikayesi ve kƒ±sa tanƒ±tƒ±mƒ±..."></textarea>
                            </div>

                            <div class="p-3 mb-3 border border-secondary rounded bg-dark">
                                <label class="text-warning mb-2 border-bottom border-secondary pb-1 w-100">TEKNƒ∞K √ñZELLƒ∞KLER (AKILLI SE√áƒ∞M)</label>
                                <div class="row g-3">
                                    
                                    <div class="col-6">
                                        <label class="text-secondary small mb-1" style="font-size:0.6rem !important;">MEKANƒ∞ZMA</label>
                                        <select id="tMek" class="form-select form-select-sm">
                                            <option value="Otomatik (ƒ∞svi√ßre)">Otomatik (ƒ∞svi√ßre)</option>
                                            <option value="Otomatik (Japon)">Otomatik (Japon)</option>
                                            <option value="Quartz (Pilli)">Quartz (Pilli)</option>
                                            <option value="Mekanik Kurmalƒ±">Mekanik Kurmalƒ±</option>
                                            <option value="Tourbillon √ñzel">Tourbillon √ñzel</option>
                                            <option value="Solar (G√ºne≈ü Enerjili)">Solar</option>
                                        </select>
                                    </div>

                                    <div class="col-6">
                                        <label class="text-secondary small mb-1" style="font-size:0.6rem !important;">KASA MATERYALƒ∞</label>
                                        <select id="tKasa" class="form-select form-select-sm">
                                            <option value="316L Paslanmaz √áelik">Paslanmaz √áelik</option>
                                            <option value="Titanyum">Titanyum</option>
                                            <option value="Altƒ±n Kaplama">Altƒ±n Kaplama</option>
                                            <option value="Karbon Fiber">Karbon Fiber</option>
                                            <option value="Seramik">Seramik</option>
                                            <option value="Bronz">Bronz</option>
                                        </select>
                                    </div>

                                    <div class="col-6">
                                        <label class="text-secondary small mb-1" style="font-size:0.6rem !important;">CAM Tƒ∞Pƒ∞</label>
                                        <select id="tCam" class="form-select form-select-sm">
                                            <option value="Safir Kristal (√áizilmez)">Safir Kristal</option>
                                            <option value="Bombeli Safir">Bombeli Safir</option>
                                            <option value="Mineral Cam">Mineral Cam</option>
                                            <option value="Hardlex Kristal">Hardlex Kristal</option>
                                            <option value="Akrilik">Akrilik</option>
                                        </select>
                                    </div>

                                    <div class="col-6">
                                        <label class="text-secondary small mb-1" style="font-size:0.6rem !important;">SU GE√áƒ∞RMEZLƒ∞K</label>
                                        <select id="tSu" class="form-select form-select-sm">
                                            <option value="3 ATM (Sƒ±√ßrama)">3 ATM</option>
                                            <option value="5 ATM (Du≈ü/Yaƒümur)">5 ATM</option>
                                            <option value="10 ATM (Y√ºzme)">10 ATM</option>
                                            <option value="20 ATM (Dalƒ±≈ü)">20 ATM</option>
                                            <option value="30 ATM (Profesyonel)">30 ATM</option>
                                        </select>
                                    </div>

                                </div>
                            </div>

                            <div class="mb-3">
                                <label>ROZET (Opsiyonel)</label>
                                <select id="uBadge" class="form-select">
                                    <option value="">Se√ßiniz...</option>
                                    <option value="YENƒ∞">‚ú® YENƒ∞</option>
                                    <option value="√áOK SATAN">üî• √áOK SATAN</option>
                                    <option value="Vƒ∞TRƒ∞N YILDIZI">‚≠ê Vƒ∞TRƒ∞N YILDIZI</option>
                                    <option value="ƒ∞NDƒ∞Rƒ∞M">üè∑Ô∏è ƒ∞NDƒ∞Rƒ∞M</option>
                                    <option value="SINIRLI">üíé SINIRLI √úRETƒ∞M</option>
                                </select>
                            </div>
                            
                            <div class="mb-4">
                                <label>√úR√úN G√ñRSELƒ∞</label>
                                <div class="file-upload-wrapper">
                                    <input type="file" id="uResimFile" class="form-control border-0" accept="image/*" onchange="resimOnizle(this)">
                                </div>
                                <div class="mt-3 text-center border border-secondary rounded p-2 bg-black" style="min-height: 100px;">
                                    <img id="imgPreview" src="" style="max-height: 100px; display: none;">
                                    <p id="noImgText" class="text-muted small m-0 pt-4" style="color:#666 !important;">G√∂rsel Se√ßilmedi</p>
                                </div>
                            </div>

                            <button type="button" class="btn btn-warning w-100 py-2 fw-bold" onclick="urunKaydet()">KAYDET VE YAYINLA</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="col-lg-7">
                <div class="card-custom">
                    <div class="card-header-custom d-flex justify-content-between align-items-center">
                        <h5 class="text-white m-0">Mevcut √úr√ºnler</h5>
                        <span class="badge bg-secondary" id="toplamUrun">0 Adet</span>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-custom table-hover mb-0">
                            <thead>
                                <tr>
                                    <th class="ps-4">G√ñRSEL</th>
                                    <th>√úR√úN ADI</th>
                                    <th>KATEGORƒ∞</th>
                                    <th>Fƒ∞YAT</th>
                                    <th class="text-end pe-4">ƒ∞≈ûLEM</th>
                                </tr>
                            </thead>
                            <tbody id="urunTablosu"></tbody>
                        </table>
                        <div id="bosListeUyari" class="text-center py-5 text-muted" style="display:none; color:#666 !important;">
                            Envanter bo≈ü. Yeni √ºr√ºn ekleyebilirsiniz.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        feather.replace();
        let secilenResimBase64 = "";

        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('show'); }

        function resimOnizle(input) {
            if (input.files && input.files[0]) {
                const file = input.files[0];
                if (file.size > 2000000) { // 2MB Limit
                    alert("‚ö†Ô∏è Resim boyutu b√ºy√ºk. Sayfa yava≈ülayabilir. (√ñnerilen < 2MB)");
                }
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('imgPreview').src = e.target.result;
                    document.getElementById('imgPreview').style.display = 'inline-block';
                    document.getElementById('noImgText').style.display = 'none';
                    secilenResimBase64 = e.target.result;
                }
                reader.readAsDataURL(file);
            }
        }

        function urunKaydet() {
            const ad = document.getElementById('uAd').value;
            const fiyat = document.getElementById('uFiyat').value;
            const kat = document.getElementById('uKat').value;
            const badge = document.getElementById('uBadge').value;
            const desc = document.getElementById('uDesc').value || "Bu √ºr√ºn i√ßin a√ßƒ±klama girilmemi≈ütir.";

            // Se√ßicilerden gelen veriler
            const teknik = {
                mekanizma: document.getElementById('tMek').value,
                kasa: document.getElementById('tKasa').value,
                cam: document.getElementById('tCam').value,
                su: document.getElementById('tSu').value
            };

            if(!ad || !fiyat) { alert("L√ºtfen √úr√ºn Adƒ± ve Fiyat alanlarƒ±nƒ± doldurunuz."); return; }
            if(!secilenResimBase64) { alert("L√ºtfen bir √ºr√ºn g√∂rseli y√ºkleyiniz."); return; }

            // Otomatik Filtreleme Etiketi
            let filterTag = "all";
            const k = kat.toLowerCase();
            if(k.includes("prestige") || k.includes("elite")) filterTag = "prestige";
            else if(k.includes("sport") || k.includes("diver")) filterTag = "sport";
            else if(k.includes("classic")) filterTag = "classic";
            else if(k.includes("limited")) filterTag = "limited";

            const yeniUrun = {
                id: Date.now(),
                ad: ad,
                kat: kat,
                fiyat: parseInt(fiyat),
                badge: badge,
                filter: filterTag,
                img: secilenResimBase64,
                desc: desc,
                teknik: teknik
            };

            try {
                const urunler = JSON.parse(localStorage.getItem('saaturnUrunler')) || [];
                urunler.unshift(yeniUrun);
                localStorage.setItem('saaturnUrunler', JSON.stringify(urunler));

                // Formu Sƒ±fƒ±rla
                document.getElementById('urunForm').reset();
                document.getElementById('imgPreview').style.display = 'none';
                document.getElementById('noImgText').style.display = 'block';
                secilenResimBase64 = "";
                
                urunleriListele();
                alert("‚úÖ √úr√ºn ba≈üarƒ±yla eklendi!");
                
            } catch (e) {
                alert("‚ùå HATA: Tarayƒ±cƒ± hafƒ±zasƒ± doldu! L√ºtfen bazƒ± eski √ºr√ºnleri silin.");
            }
        }

        function urunleriListele() {
            const urunler = JSON.parse(localStorage.getItem('saaturnUrunler')) || [];
            const tablo = document.getElementById('urunTablosu');
            tablo.innerHTML = "";
            document.getElementById('toplamUrun').innerText = urunler.length + " Adet";

            if(urunler.length === 0) {
                document.getElementById('bosListeUyari').style.display = 'block';
            } else {
                document.getElementById('bosListeUyari').style.display = 'none';
                urunler.forEach((u, index) => {
                    tablo.innerHTML += `
                        <tr>
                            <td class="ps-4"><img src="${u.img}" class="product-thumb"></td>
                            <td class="fw-bold text-white">${u.ad}</td>
                            <td>${u.kat}</td>
                            <td class="text-warning">${u.fiyat.toLocaleString()} ‚Ç∫</td>
                            <td class="text-end pe-4">
                                <button class="btn btn-sm btn-outline-danger" onclick="urunSil(${index})">Sil</button>
                            </td>
                        </tr>
                    `;
                });
            }
        }

        function urunSil(index) {
            if(confirm("Bu √ºr√ºn√º kalƒ±cƒ± olarak silmek istiyor musunuz?")) {
                const urunler = JSON.parse(localStorage.getItem('saaturnUrunler'));
                urunler.splice(index, 1);
                localStorage.setItem('saaturnUrunler', JSON.stringify(urunler));
                urunleriListele();
            }
        }
        
        function cikisYap() {
            localStorage.removeItem("saaturn_session");
            window.location.href = "index.html"; 
        }
    </script>
</body>
</html>
